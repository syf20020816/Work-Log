# GenUI 计算属性指南

## 什么是计算属性？
计算属性（Computed Property）是基于现有属性动态计算出的值，在 GenUI 中，计算属性不会存储状态，而是根据其依赖项的变化自动更新。

## 计算属性 vs 普通属性 vs 双向绑定

| 特性        | 普通属性 (Prop) | 计算属性 (Computed) | 双向绑定 (Two-way Binding) |
|------------|---------------|------------------|------------------|
| 是否存储状态 | ✅ 是           | ❌ 否              | ✅ 是              |
| 是否可变    | ✅ 是           | ✅ 依赖项变化时更新 | ✅ 是              |
| 是否可手动修改 | ✅ set_xxx 方法  | ✅ 但不能使用 set_xxx 方法 | ✅ 通过 set_xxx 修改 |
| 依赖数据   | ❌ 无           | ✅ 需要依赖项       | ✅ 组件状态 |

## 计算属性的使用

```rust
impl MyComponent {
    #[computed([count])]
    fn is_even(&mut self) -> bool {
        self.count += 1; // ✅ 允许修改自身状态，但不能使用 set_count 方法
        self.count % 2 == 0
    }
}
```

## 错误示范

```rust
impl MyComponent {
    #[computed([count])]
    fn is_even(&mut self) -> bool {
        self.set_count(self.count + 1); // ❌ 错误！计算属性不应依赖 set_xxx 方法
        self.count % 2 == 0
    }
}
```

计算属性的核心原则是：**它是一个计算结果，而不是存储的值。** 在计算过程中，它可以修改自身的内部状态（如 `self.count += 1`），但不能依赖 `set_xxx` 方法来更新值。

## 计算属性的最佳实践
1. **避免修改其他状态**：计算属性的计算逻辑应尽量保持纯粹，不影响其他状态。
2. **慎重使用可变借用**：如果计算属性修改了自身状态，需确保不会引发竞态问题。
3. **不要与 `set_xxx` 结合**：计算属性应该让开发者直接处理逻辑，而非依赖双向绑定的 `set_xxx`。

计算属性提供了一种简洁的方式来动态计算组件的状态，使代码更加直观、现代化。

